<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.rainier.dao.ExpertVideoDao" >
  <resultMap id="BaseResultMap" type="com.rainier.pojo.ExpertVideoDo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="uuid" property="uuid" jdbcType="VARCHAR" />
    <result column="title" property="title" jdbcType="VARCHAR" />
    <result column="cover_img_url" property="coverImgUrl" jdbcType="VARCHAR" />
    <result column="introduction" property="introduction" jdbcType="VARCHAR" />
    <result column="file_url" property="fileUrl" jdbcType="VARCHAR" />
    <result column="created" property="created" jdbcType="TIMESTAMP" />
    <result column="modified" property="modified" jdbcType="TIMESTAMP" />
    <result column="modified_by" property="modifiedBy" jdbcType="VARCHAR" />
    <result column="create_by" property="createBy" jdbcType="VARCHAR" />
    <result column="export_name" property="exportName" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="VARCHAR" />
  </resultMap>
  <select id="selectVideoTops"
          resultType="com.rainier.pojo.ResourceModel">
    SELECT
    n.uuid,n.keyWord,
    n.title,n.file_url as imgUrl,n.duration,n.export_name as userName,DATE_FORMAT(n.created,'%Y年%m月%d日') as createDateStr,n.created as createDate,
    ifnull(
    (
    e.browse_num + e.comment_num + e.like_num + e.share_num + e.favorite_num + e.download_num + e.note_num
    ),
    0
    ) AS totalNum,ifnull(e.dislike_num,0) as dislikeNum,ifnull(e.like_num,0) as likeNum,
    ifnull(e.comment_num,0) as commentNum,ifnull(e.share_num,0) as shareNum,
    ifnull(e.browse_num,0) as browseNum,ifnull(e.download_num,0) as downloadNum,
    ifnull(e.favorite_num,0) as favoriteNum,ifnull(e.note_num,0) as noteNum
    FROM
    expert_video n
    left join item_ext e ON e.item_uuid = n.uuid
    order by n.created desc
    <if test="num !=0">
      LIMIT #{num};
    </if>
  </select>

  <select id="selectVideoByIds" resultType="com.rainier.pojo.ResourceModel">
    SELECT
    n.uuid,n.keyWord,
    n.title,n.cover_img_url as imgUrl , n.file_url as fileUrl,n.duration,n.export_name as userName,DATE_FORMAT(n.created,'%Y年%m月%d日') as createDateStr,n.created as createDate,
    ifnull(
    (
    e.browse_num + e.comment_num + e.like_num + e.share_num + e.favorite_num + e.download_num + e.note_num
    ),
    0
    ) AS totalNum,ifnull(e.dislike_num,0) as dislikeNum,ifnull(e.like_num,0) as likeNum,
    ifnull(e.comment_num,0) as commentNum,ifnull(e.share_num,0) as shareNum,
    ifnull(e.browse_num,0) as browseNum,ifnull(e.download_num,0) as downloadNum,
    ifnull(e.favorite_num,0) as favoriteNum,ifnull(e.note_num,0) as noteNum
    FROM
    expert_video n
    left join item_ext e ON e.item_uuid = n.uuid
    where n.id in
    <foreach collection="list" item="id" index="index"
             open="(" close=")" separator=",">
      #{id}
    </foreach>
  </select>
</mapper>